<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rankly - Branching Tree Visualization</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/reactflow@11.10.4/dist/umd/index.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'Helvetica Neue', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        background: 'hsl(0 0% 100%)',
                        foreground: 'hsl(0 0% 0%)',
                        card: 'hsl(0 0% 100%)',
                        'card-foreground': 'hsl(0 0% 0%)',
                        popover: 'hsl(0 0% 100%)',
                        'popover-foreground': 'hsl(0 0% 0%)',
                        primary: 'hsl(0 0% 0%)',
                        'primary-foreground': 'hsl(0 0% 100%)',
                        secondary: 'hsl(0 0% 96%)',
                        'secondary-foreground': 'hsl(0 0% 0%)',
                        muted: 'hsl(0 0% 96%)',
                        'muted-foreground': 'hsl(0 0% 45%)',
                        accent: 'hsl(0 0% 96%)',
                        'accent-foreground': 'hsl(0 0% 0%)',
                        destructive: 'hsl(0 0% 0%)',
                        'destructive-foreground': 'hsl(0 0% 100%)',
                        border: 'hsl(0 0% 90%)',
                        input: 'hsl(0 0% 90%)',
                        ring: 'hsl(0 0% 0%)',
                        radius: '0.5rem',
                    }
                }
            }
        }
    </script>
    <style>
        .dark {
            --background: 0 0% 0%;
            --foreground: 0 0% 100%;
            --card: 0 0% 0%;
            --card-foreground: 0 0% 100%;
            --popover: 0 0% 0%;
            --popover-foreground: 0 0% 100%;
            --primary: 0 0% 100%;
            --primary-foreground: 0 0% 0%;
            --secondary: 0 0% 15%;
            --secondary-foreground: 0 0% 100%;
            --muted: 0 0% 15%;
            --muted-foreground: 0 0% 65%;
            --accent: 0 0% 15%;
            --accent-foreground: 0 0% 100%;
            --destructive: 0 0% 100%;
            --destructive-foreground: 0 0% 0%;
            --border: 0 0% 20%;
            --input: 0 0% 20%;
            --ring: 0 0% 100%;
        }

        body {
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            font-family: 'Inter', 'Helvetica Neue', system-ui, sans-serif;
            margin: 0;
            padding: 0;
        }

        /* React Flow Styles */
        .react-flow__node {
            background: transparent !important;
            border: none !important;
            padding: 0 !important;
        }

        .react-flow__edge {
            stroke: hsl(var(--border)) !important;
            stroke-width: 2 !important;
        }

        .react-flow__edge-path {
            stroke: hsl(var(--border)) !important;
            stroke-width: 2 !important;
        }

        .react-flow__controls {
            background: hsl(var(--card)) !important;
            border: 1px solid hsl(var(--border)) !important;
            border-radius: 0.5rem !important;
        }

        .react-flow__controls-button {
            background: transparent !important;
            border: none !important;
            color: hsl(var(--foreground)) !important;
        }

        .react-flow__controls-button:hover {
            background: hsl(var(--muted)) !important;
        }

        /* Custom Node Styles */
        .branching-node {
            background: hsl(var(--card));
            border: 2px solid hsl(var(--border));
            border-radius: 0.75rem;
            padding: 1rem;
            box-shadow: 0 1px 3px 0 hsl(var(--foreground) / 0.1);
            transition: all 0.2s ease;
            min-width: 120px;
            text-align: center;
        }

        .branching-node:hover {
            border-color: hsl(var(--foreground) / 0.3);
            box-shadow: 0 4px 6px -1px hsl(var(--foreground) / 0.1);
        }

        .branching-node.selected {
            border-color: hsl(var(--foreground));
            box-shadow: 0 0 0 2px hsl(var(--foreground) / 0.2);
        }

        .root-node {
            background: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
            border: 2px solid hsl(var(--primary));
            border-radius: 1rem;
            padding: 0.75rem;
            min-width: 80px;
            text-align: center;
            box-shadow: 0 2px 4px hsl(var(--foreground) / 0.1);
        }

        .root-node:hover {
            background: hsl(var(--primary) / 0.9);
        }

        .root-node.selected {
            box-shadow: 0 0 0 2px hsl(var(--foreground) / 0.3);
        }

        .node-text {
            font-size: 0.875rem;
            font-weight: 500;
            line-height: 1.25;
        }

        .root-text {
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* Animation Styles */
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .animate-in {
            animation: fadeInScale 0.3s ease-out;
        }

        /* ShadCN Components */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
            border: 1px solid hsl(var(--border));
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            padding: 0.5rem 1rem;
            cursor: pointer;
        }

        .btn:hover {
            background-color: hsl(var(--accent));
        }

        .switch {
            position: relative;
            display: inline-flex;
            height: 1.5rem;
            width: 2.75rem;
            border-radius: 9999px;
            border: 1px solid hsl(var(--border));
            background-color: hsl(var(--muted));
            cursor: pointer;
            transition: all 0.2s;
        }

        .switch[data-state="checked"] {
            background-color: hsl(var(--primary));
        }

        .switch-thumb {
            display: block;
            height: 1.25rem;
            width: 1.25rem;
            border-radius: 9999px;
            background-color: hsl(var(--background));
            border: 1px solid hsl(var(--border));
            transition: transform 0.2s;
            transform: translateX(0.125rem);
        }

        .switch[data-state="checked"] .switch-thumb {
            transform: translateX(1.375rem);
        }
    </style>
</head>
<body class="h-screen bg-background text-foreground">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;
        const { ReactFlow, Background, Controls, useNodesState, useEdgesState, addEdge, MarkerType } = ReactFlow;

        // Theme Toggle Component
        const ThemeToggle = () => {
            const [isDark, setIsDark] = useState(() => {
                return localStorage.getItem('theme') === 'dark' || 
                       (!localStorage.getItem('theme') && window.matchMedia('(prefers-color-scheme: dark)').matches);
            });

            useEffect(() => {
                if (isDark) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
            }, [isDark]);

            return (
                <div className="flex items-center gap-2">
                    <span className="text-sm text-muted-foreground">Light</span>
                    <button 
                        className="switch" 
                        data-state={isDark ? "checked" : "unchecked"}
                        onClick={() => setIsDark(!isDark)}
                    >
                        <span className="switch-thumb"></span>
                    </button>
                    <span className="text-sm text-muted-foreground">Dark</span>
                </div>
            );
        };

        // Custom Node Components
        const RootNode = ({ data, selected }) => {
            return (
                <div className={`root-node ${selected ? 'selected' : ''} animate-in`}>
                    <div className="flex flex-col items-center gap-1">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                            <path d="M7 17L17 7M17 7H7M17 7V17"/>
                        </svg>
                        <span className="root-text">{data.label}</span>
                    </div>
                </div>
            );
        };

        const BranchNode = ({ data, selected }) => {
            return (
                <div className={`branching-node ${selected ? 'selected' : ''} animate-in`}>
                    <div className="node-text">{data.label}</div>
                </div>
            );
        };

        const nodeTypes = {
            rootNode: RootNode,
            branchNode: BranchNode,
        };

        // Main Branching Tree Component
        const BranchingTree = () => {
            const [nodes, setNodes, onNodesChange] = useNodesState([
                {
                    id: '1',
                    type: 'rootNode',
                    position: { x: 250, y: 50 },
                    data: { label: 'Root' },
                    draggable: true,
                },
                {
                    id: '2',
                    type: 'branchNode',
                    position: { x: 100, y: 200 },
                    data: { label: 'Project management tools like' },
                    draggable: true,
                },
                {
                    id: '3',
                    type: 'branchNode',
                    position: { x: 250, y: 200 },
                    data: { label: 'Project management tools include' },
                    draggable: true,
                },
                {
                    id: '4',
                    type: 'branchNode',
                    position: { x: 400, y: 200 },
                    data: { label: 'Using project management tool' },
                    draggable: true,
                },
                {
                    id: '5',
                    type: 'branchNode',
                    position: { x: 50, y: 350 },
                    data: { label: 'Task tracking features' },
                    draggable: true,
                },
                {
                    id: '6',
                    type: 'branchNode',
                    position: { x: 200, y: 350 },
                    data: { label: 'Team collaboration tools' },
                    draggable: true,
                },
                {
                    id: '7',
                    type: 'branchNode',
                    position: { x: 350, y: 350 },
                    data: { label: 'Project timeline management' },
                    draggable: true,
                },
            ]);

            const [edges, setEdges, onEdgesChange] = useEdgesState([
                {
                    id: 'e1-2',
                    source: '1',
                    target: '2',
                    type: 'smoothstep',
                    markerEnd: {
                        type: MarkerType.ArrowClosed,
                        width: 20,
                        height: 20,
                        color: 'hsl(var(--border))',
                    },
                    style: {
                        strokeWidth: 2,
                        stroke: 'hsl(var(--border))',
                    },
                },
                {
                    id: 'e1-3',
                    source: '1',
                    target: '3',
                    type: 'smoothstep',
                    markerEnd: {
                        type: MarkerType.ArrowClosed,
                        width: 20,
                        height: 20,
                        color: 'hsl(var(--border))',
                    },
                    style: {
                        strokeWidth: 2,
                        stroke: 'hsl(var(--border))',
                    },
                },
                {
                    id: 'e1-4',
                    source: '1',
                    target: '4',
                    type: 'smoothstep',
                    markerEnd: {
                        type: MarkerType.ArrowClosed,
                        width: 20,
                        height: 20,
                        color: 'hsl(var(--border))',
                    },
                    style: {
                        strokeWidth: 2,
                        stroke: 'hsl(var(--border))',
                    },
                },
                {
                    id: 'e2-5',
                    source: '2',
                    target: '5',
                    type: 'smoothstep',
                    markerEnd: {
                        type: MarkerType.ArrowClosed,
                        width: 20,
                        height: 20,
                        color: 'hsl(var(--border))',
                    },
                    style: {
                        strokeWidth: 2,
                        stroke: 'hsl(var(--border))',
                    },
                },
                {
                    id: 'e3-6',
                    source: '3',
                    target: '6',
                    type: 'smoothstep',
                    markerEnd: {
                        type: MarkerType.ArrowClosed,
                        width: 20,
                        height: 20,
                        color: 'hsl(var(--border))',
                    },
                    style: {
                        strokeWidth: 2,
                        stroke: 'hsl(var(--border))',
                    },
                },
                {
                    id: 'e4-7',
                    source: '4',
                    target: '7',
                    type: 'smoothstep',
                    markerEnd: {
                        type: MarkerType.ArrowClosed,
                        width: 20,
                        height: 20,
                        color: 'hsl(var(--border))',
                    },
                    style: {
                        strokeWidth: 2,
                        stroke: 'hsl(var(--border))',
                    },
                },
            ]);

            const onConnect = useCallback((params) => setEdges((eds) => addEdge(params, eds)), [setEdges]);

            return (
                <div className="h-full w-full">
                    <ReactFlow
                        nodes={nodes}
                        edges={edges}
                        onNodesChange={onNodesChange}
                        onEdgesChange={onEdgesChange}
                        onConnect={onConnect}
                        nodeTypes={nodeTypes}
                        fitView
                        attributionPosition="bottom-left"
                        defaultViewport={{ x: 0, y: 0, zoom: 0.8 }}
                        minZoom={0.1}
                        maxZoom={2}
                        nodesDraggable={true}
                        nodesConnectable={false}
                        elementsSelectable={true}
                    >
                        <Background 
                            color="hsl(var(--muted))" 
                            gap={20} 
                            size={1}
                            variant="dots"
                        />
                        <Controls 
                            showInteractive={false}
                            position="bottom-right"
                        />
                    </ReactFlow>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            return (
                <div className="h-screen flex flex-col">
                    {/* Header */}
                    <header className="border-b border-border bg-background px-6 py-4">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center gap-4">
                                <h1 className="text-2xl font-black tracking-tight text-foreground">
                                    Rankly
                                </h1>
                                <span className="text-lg font-medium text-muted-foreground">
                                    Branching Tree Visualization
                                </span>
                            </div>
                            <ThemeToggle />
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="flex-1 relative">
                        <BranchingTree />
                    </main>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
